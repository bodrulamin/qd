<div class="h-screen w-screen">

  <!-----------------------header------------------->
  <div class="h-2rem">

    <div class="flex flex-row w-full">

      <!-----------------------ExpanColapse Resource------------------->
      <div class="ml-2 flex flex-grow-0 justify-content-center align-items-center">
        <div class="justify-content-center align-items-baseline text-center">
          <p-button size="small" [text]="true" [label]="showResources ? 'Collapse Resources <<':'Show Resources >>'"
                    (onClick)="showResources = !showResources"></p-button>
        </div>
      </div>

      <!-----------------------Exam Status------------------->
      <div class="flex flex-grow-1 justify-content-center align-items-center">
        <div class="info">

          Subject: {{ examInfo.subjectName }}
        </div>

        {{ selectedIndex < 0 ? '-' : selectedIndex + 1 }}/{{ questionDetails.length }}

        <div class="info">
          Remaining Time: {{ remainingTime }}
        </div>


      </div>
      <div class="flex flex-grow-0 right-0 mr-5 justify-content-center align-items-center">
        <p-button size="small" label="" [text]="true" icon="fas fa-calculator"
                  (onClick)="calulatorVisible = true"></p-button>
        <p-button size="small" label='Save Answer' (onClick)="manualSave()"></p-button>

      </div>

    </div>
  </div>

  <!-----------------------Body------------------->


  <div class="flex flex-row h-full">
    <!-----------------------Resources------------------->
    <div *ngIf="showResources" class="card w-10rem m-2 p-2 h-full flex-grow-0 flex-shrink-0 overflow-y-auto"
         style="background-color:#f8f6f6">
      <div class="mb-5 w-full"
           *ngFor="let item of questionDetails; index as i;">
        <div class="card" [ngClass]="{'border border-2 border-blue-400': selectedIndex === i}"
             (click)="selectQuestion(i)"
             [style]="{overflow:'clip',padding:0, width:'100%'}">
          <div class="relative">
            <div
              class="top-0 left-0 font-bold align-items-center justify-content-center w-full">
              <div class="flex justify-content-between align-items-start">
                <div class="m-2">
                  <p-badge [severity]="i===selectedIndex ? 'info':'warning'"
                           [value]='item.seqNo.toString()'></p-badge>
                </div>
              </div>

            </div>

          </div>
          <div class="h-10rem">
            <img *ngIf="thumbnailBlobMap.get(item.id)" style="width:100%; overflow:clip;padding:5px "
                 src="{{thumbnailBlobMap.get(item.id)}}"
                 alt="thumbnail">
          </div>

        </div>
      </div>
    </div>
    <div class="flex flex-grow-1 m-2">
      <as-split direction="horizontal">
        <as-split-area [size]="50">
          <div id="html-preview"></div>

<!--          <div class="h-full">-->

            <as-split direction="vertical">

              <as-split-area>
                <div id="question-container" class="h-full relative">
                  <div class="absolute w-full" style="z-index: 22">
                    <div
                      class="top-0 w-full">
                        <div class="m-2 flex justify-content-between">
                          <p-badge [severity]="'info'"
                                   [value]='questionDetail.seqNo.toString()'></p-badge>
                          <p-button [text]="true" (onClick)="pinnedItems.push(questionDetail)"><i class="fas fa-thumbtack -rotate-90"></i></p-button>
                      </div>

                    </div>
                  </div>
                  <div class="card h-full w-full" id="question-view" *ngIf="!questionDetail.isFile"
                       [innerHTML]="questionDetail.quesDesc"></div>

                  <pdf-viewer [zoom]="1" *ngIf="questionDetail.isFile" class="h-full" #pdfView
                              [src]="pdfBlobMap.get(questionDetail.id)"
                              [render-text]="false"
                              [original-size]="true">

                  </pdf-viewer>
                </div>
              </as-split-area>

              <as-split-area [size]="50/pinnedItems.length" *ngFor="let question of pinnedItems">
                <div class="h-full relative">
                  <div class="absolute w-full" style="z-index: 22">
                    <div
                      class="top-0 w-full">
                      <div class="m-2 flex justify-content-between">
                        <p-badge [severity]="'warning'"
                                 [value]='question.seqNo.toString()'></p-badge>
                        <p-button severity="secondary" [text]="true" (onClick)="pinnedItems.splice(0,1)"><i class="fas fa-thumbtack"></i></p-button>
                      </div>

                    </div>
                  </div>
                  <div class="card w-full absolute " style="z-index: 0" *ngIf="!question.isFile"
                       [innerHTML]="question.quesDesc"></div>

                  <pdf-viewer [zoom]="1" *ngIf="question.isFile" class="h-full" #pdfView
                              [src]="pdfBlobMap.get(question.id)"
                              [render-text]="false"
                              [original-size]="true">

                  </pdf-viewer>
                </div>
              </as-split-area>



            </as-split>

<!--          </div>-->


        </as-split-area>


        <!--       ------------------Right Pane------------------------>
        <as-split-area [size]="50">
          <as-split direction="vertical">
            <as-split-area [size]="40">
              <editor apiKey="y6iz5y6rybj6vsjuhyvg8c533qvoeq2u5hvdmvddhn00tv0t" (onPaste)="onPaste($event)"
                      [disabled]="selectedIndex < 0"
                      [(ngModel)]="answer.answerDesc"
                      [init]="{ plugins: 'table lists' , menubar: '', toolbar: 'undo redo styles bold italic underline fontsize table alignleft aligncenter alignright alignjustify lists'}"
              ></editor>

            </as-split-area>
            <as-split-area [size]="60">
              <div class="overflow-hidden">
                <div id="luckysheet" style="margin:0px;padding:0px;position:absolute;width:100%;height:50%;"></div>
              </div>
            </as-split-area>
          </as-split>
        </as-split-area>
      </as-split>


    </div>

  </div>

</div>

<p-dialog [(visible)]="calulatorVisible" [modal]="false" [style]="{width: scientificMode ? '778px' : '300px'}">
  <ng-template pTemplate="header">
    <p-toggleButton [(ngModel)]="scientificMode" onLabel="Normal" offLabel="Scientific"></p-toggleButton>
  </ng-template>
  <app-scientific-calculator [scientificMode]="scientificMode"></app-scientific-calculator>
</p-dialog>



